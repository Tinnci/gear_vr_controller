<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="GearVRController.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:GearVRController"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls"
    mc:Ignorable="d"
    Title="GearVRController">

    <Grid Padding="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Spacing="12">
            <TextBlock Text="Gear VR Controller" Style="{StaticResource TitleTextBlockStyle}"/>
            
            <!-- 状态显示区域 -->
            <Border BorderBrush="{ThemeResource SystemControlForegroundBaseMediumBrush}" 
                    BorderThickness="1" Padding="12" CornerRadius="4">
                <StackPanel Spacing="8">
                    <TextBlock Text="连接状态" FontWeight="SemiBold"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Ellipse Width="12" Height="12" Margin="0,0,8,0" VerticalAlignment="Center"
                                Fill="{Binding IsConnected, Converter={StaticResource BoolToConnectionColorConverter}}"/>
                        <TextBlock Grid.Column="1" Text="{Binding StatusMessage}" VerticalAlignment="Center"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- 控制按钮区域 -->
            <StackPanel Orientation="Horizontal" Spacing="12">
                <Button x:Name="ConnectButton" 
                        Content="连接设备" 
                        Click="ConnectButton_Click"
                        IsEnabled="{Binding IsConnecting, Converter={StaticResource BoolToInverseConverter}}"/>
                <Button x:Name="DisconnectButton" 
                        Content="断开连接" 
                        Click="DisconnectButton_Click"
                        IsEnabled="{Binding IsConnected}"/>
                <Button x:Name="ToggleControlButton"
                        Content="{Binding IsControlEnabled, Converter={StaticResource BoolToControlStateConverter}}"
                        Click="ToggleControlButton_Click"/>
            </StackPanel>

            <StackPanel Spacing="8">
                <TextBlock Text="控制设置" Style="{StaticResource SubtitleTextBlockStyle}"/>
                
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <CheckBox Content="启用鼠标控制" 
                             IsChecked="{Binding IsMouseEnabled, Mode=TwoWay}"/>
                    <CheckBox Content="启用键盘控制" 
                             IsChecked="{Binding IsKeyboardEnabled, Mode=TwoWay}"/>
                </StackPanel>

                <StackPanel>
                    <TextBlock Text="鼠标灵敏度"/>
                    <Slider Minimum="0.1" 
                            Maximum="2.0" 
                            Value="{Binding MouseSensitivity, Mode=TwoWay}"
                            Width="200"
                            HorizontalAlignment="Left"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Spacing="12">
                    <Button Content="重置设置" 
                            Click="ResetSettingsButton_Click"/>
                    <Button Content="校准触摸板"
                            Click="CalibrateButton_Click"/>
                </StackPanel>
            </StackPanel>

            <!-- 传感器数据显示区域 -->
            <Expander Header="传感器数据" IsExpanded="False">
                <Grid Margin="0,8,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- 加速度计数据 -->
                    <StackPanel Grid.Row="0" Grid.Column="0" Margin="4">
                        <TextBlock Text="加速度计" FontWeight="SemiBold"/>
                        <TextBlock Margin="0,4,0,0">
                            <Run Text="X: "/>
                            <Run Text="{Binding LastControllerData.AccelX, Mode=OneWay}"/>
                        </TextBlock>
                        <TextBlock Margin="0,4,0,0">
                            <Run Text="Y: "/>
                            <Run Text="{Binding LastControllerData.AccelY, Mode=OneWay}"/>
                        </TextBlock>
                        <TextBlock Margin="0,4,0,0">
                            <Run Text="Z: "/>
                            <Run Text="{Binding LastControllerData.AccelZ, Mode=OneWay}"/>
                        </TextBlock>
                    </StackPanel>

                    <!-- 陀螺仪数据 -->
                    <StackPanel Grid.Row="0" Grid.Column="1" Margin="4">
                        <TextBlock Text="陀螺仪" FontWeight="SemiBold"/>
                        <TextBlock Margin="0,4,0,0">
                            <Run Text="X: "/>
                            <Run Text="{Binding LastControllerData.GyroX, Mode=OneWay}"/>
                        </TextBlock>
                        <TextBlock Margin="0,4,0,0">
                            <Run Text="Y: "/>
                            <Run Text="{Binding LastControllerData.GyroY, Mode=OneWay}"/>
                        </TextBlock>
                        <TextBlock Margin="0,4,0,0">
                            <Run Text="Z: "/>
                            <Run Text="{Binding LastControllerData.GyroZ, Mode=OneWay}"/>
                        </TextBlock>
                    </StackPanel>

                    <!-- 磁力计数据 -->
                    <StackPanel Grid.Row="0" Grid.Column="2" Margin="4">
                        <TextBlock Text="磁力计" FontWeight="SemiBold"/>
                        <TextBlock Margin="0,4,0,0">
                            <Run Text="X: "/>
                            <Run Text="{Binding LastControllerData.MagnetX, Mode=OneWay}"/>
                        </TextBlock>
                        <TextBlock Margin="0,4,0,0">
                            <Run Text="Y: "/>
                            <Run Text="{Binding LastControllerData.MagnetY, Mode=OneWay}"/>
                        </TextBlock>
                        <TextBlock Margin="0,4,0,0">
                            <Run Text="Z: "/>
                            <Run Text="{Binding LastControllerData.MagnetZ, Mode=OneWay}"/>
                        </TextBlock>
                    </StackPanel>

                    <!-- 触摸板数据 -->
                    <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Margin="4,12,4,4">
                        <TextBlock Text="触摸板" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                            <TextBlock>
                                <Run Text="X: "/>
                                <Run Text="{Binding LastControllerData.AxisX, Mode=OneWay}"/>
                            </TextBlock>
                            <TextBlock Margin="12,0,0,0">
                                <Run Text="Y: "/>
                                <Run Text="{Binding LastControllerData.AxisY, Mode=OneWay}"/>
                            </TextBlock>
                        </StackPanel>
                    </StackPanel>

                    <!-- 按钮状态 -->
                    <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Margin="4,12,4,4">
                        <TextBlock Text="按钮状态" FontWeight="SemiBold"/>
                        <ItemsControl Margin="0,4,0,0">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <controls:WrapPanel/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,12,4">
                                <Ellipse Width="8" Height="8" Margin="0,0,4,0" VerticalAlignment="Center"
                                         Fill="{Binding LastControllerData.TriggerButton, Converter={StaticResource BoolToButtonStateConverter}}"/>
                                <TextBlock Text="触发键"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,12,4">
                                <Ellipse Width="8" Height="8" Margin="0,0,4,0" VerticalAlignment="Center"
                                         Fill="{Binding LastControllerData.HomeButton, Converter={StaticResource BoolToButtonStateConverter}}"/>
                                <TextBlock Text="Home键"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,12,4">
                                <Ellipse Width="8" Height="8" Margin="0,0,4,0" VerticalAlignment="Center"
                                         Fill="{Binding LastControllerData.BackButton, Converter={StaticResource BoolToButtonStateConverter}}"/>
                                <TextBlock Text="返回键"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,12,4">
                                <Ellipse Width="8" Height="8" Margin="0,0,4,0" VerticalAlignment="Center"
                                         Fill="{Binding LastControllerData.TouchpadButton, Converter={StaticResource BoolToButtonStateConverter}}"/>
                                <TextBlock Text="触摸板"/>
                            </StackPanel>
                        </ItemsControl>
                    </StackPanel>
                </Grid>
            </Expander>
        </StackPanel>
    </Grid>
</Window>
